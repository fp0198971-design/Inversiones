<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" href="./img/inver.webp" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Libertad Financiera 360 App</title>
    <!-- Incluye Tailwind CSS para el estilizado -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Estilo básico para asegurar que la app ocupe toda la pantalla */
      #root {
        min-height: 100vh;
      }
      /* Fuente Inter (usada por defecto con Tailwind) */
      :root {
        font-family: 'Inter', sans-serif;
      }
    </style>
</head>
<body>
    <!-- Contenedor donde se montará la aplicación React -->
    <div id="root"></div>

    <!-- 1. Carga React y ReactDOM desde CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.js"></script>
    <!-- 2. Carga Babel para transpilar JSX en el navegador -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- 3. Contiene todo el código de la aplicación React -->
    <script type="text/babel">
        const { useState, useMemo } = React;

        // --- ICONOS SVG AUTOCONTENIDOS (Reemplazo de lucide-react) ---
        // Se definen los íconos como componentes de React usando SVG para evitar dependencias externas.

        const createIcon = (dPath) => ({ size = 20, className = "" }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round"
                className={className}
            >
                <path d={dPath} />
            </svg>
        );

        const PieChart = createIcon("M21.21 15.89A10 10 0 1 1 8 2.83M22 12A10 10 0 0 0 12 2v10z");
        const Wallet = createIcon("M21 12V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-5M2 7h20M7 12h8M16 12h2M18 16a2 2 0 0 1-2 2h-4a2 2 0 0 1-2-2v-4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v4z");
        const TrendingUp = createIcon("M12 2L19 9L21 7M21 7V22M3 17l6-6 4 4 8-8");
        const Activity = createIcon("M22 12h-4l-3 9L9 3l-3 9H2");
        const Plus = createIcon("M12 5v14M5 12h14");
        const Trash2 = createIcon("M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6M10 11v6M14 11v6M9 4h6");
        const ArrowUpRight = createIcon("M7 17L17 7M17 7H7M17 7V17");
        const ArrowDownRight = createIcon("M17 7L7 17M7 17H17M7 17V7");
        const Target = createIcon("M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0-18 0M12 12m-6 0a6 6 0 1 0 12 0a6 6 0 1 0-12 0M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0-6 0");
        const Shield = createIcon("M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z");
        const Briefcase = createIcon("M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2M12 11v6M15 14h-6");
        const Menu = createIcon("M3 12h18M3 6h18M3 18h18");
        const X = createIcon("M18 6L6 18M6 6l12 12");
        const DollarSign = createIcon("M12 2c5.52 0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16zM8 11h8M8 15h8M12 8v8");


        // --- COMPONENTES UI BÁSICOS ---

        const Card = ({ children, className = "" }) => (
          <div className={`bg-white rounded-xl shadow-sm border border-slate-100 p-6 ${className}`}>
            {children}
          </div>
        );

        const Button = ({ onClick, children, variant = "primary", className = "", icon: Icon }) => {
          const baseStyle = "flex items-center justify-center gap-2 px-4 py-2 rounded-lg font-medium transition-all duration-200 active:scale-95";
          const variants = {
            primary: "bg-indigo-600 text-white hover:bg-indigo-700 shadow-md shadow-indigo-200",
            secondary: "bg-white text-slate-700 border border-slate-200 hover:bg-slate-50",
            danger: "bg-red-50 text-red-600 hover:bg-red-100",
            ghost: "text-slate-500 hover:text-slate-800 hover:bg-slate-100"
          };
          
          return (
            <button onClick={onClick} className={`${baseStyle} ${variants[variant]} ${className}`}>
              {Icon && <Icon size={18} />}
              {children}
            </button>
          );
        };

        // --- COMPONENTES GRÁFICOS PERSONALIZADOS (SVG) ---

        const SimplePieChart = ({ data, colors }) => {
          const total = data.reduce((acc, item) => acc + item.value, 0);
          let accumulatedAngle = 0;

          if (total === 0) return (
            <div className="h-64 flex items-center justify-center text-slate-400 bg-slate-50 rounded-full border-2 border-dashed border-slate-200">
              Sin datos
            </div>
          );

          return (
            <div className="relative h-64 w-64 mx-auto">
              <svg viewBox="-1 -1 2 2" className="transform -rotate-90 w-full h-full">
                {data.map((slice, index) => {
                  const percentage = slice.value / total;
                  const angle = percentage * Math.PI * 2;
                  const x1 = Math.cos(accumulatedAngle);
                  const y1 = Math.sin(accumulatedAngle);
                  const x2 = Math.cos(accumulatedAngle + angle);
                  const y2 = Math.sin(accumulatedAngle + angle);
                  const largeArcFlag = percentage > 0.5 ? 1 : 0;
                  
                  const pathData = `M 0 0 L ${x1} ${y1} A 1 1 0 ${largeArcFlag} 1 ${x2} ${y2} Z`;
                  accumulatedAngle += angle;

                  return (
                    <path
                      key={slice.name}
                      d={pathData}
                      fill={colors[index % colors.length]}
                      className="hover:opacity-80 transition-opacity cursor-pointer"
                    >
                      <title>{`${slice.name}: ${Math.round(percentage * 100)}%`}</title>
                    </path>
                  );
                })}
              </svg>
              {/* Centro blanco para efecto Donut (Opcional) */}
              <div className="absolute inset-0 m-auto w-1/2 h-1/2 bg-white rounded-full flex items-center justify-center shadow-inner">
                <span className="text-xs font-bold text-slate-500">Total</span>
              </div>
            </div>
          );
        };

        const BarChart = ({ data, height = 200 }) => {
          const maxVal = Math.max(...data.map(d => d.value), 1);
          return (
            <div className="flex items-end justify-between gap-2" style={{ height }}>
              {data.map((d, i) => (
                <div key={i} className="flex flex-col items-center w-full group relative">
                  <div 
                    className="w-full bg-indigo-500 rounded-t-sm transition-all duration-500 hover:bg-indigo-600"
                    style={{ height: `${(d.value / maxVal) * 100}%` }}
                  >
                     <div className="opacity-0 group-hover:opacity-100 absolute -top-10 left-1/2 transform -translate-x-1/2 bg-slate-800 text-white text-xs px-2 py-1 rounded pointer-events-none whitespace-nowrap z-10">
                      ${d.value.toLocaleString()}
                    </div>
                  </div>
                  <span className="text-xs text-slate-500 mt-2 truncate w-full text-center">{d.label}</span>
                </div>
              ))}
            </div>
          );
        };

        // --- UTILIDADES ---

        const formatCurrency = (amount) => {
          // Formatea a pesos mexicanos (MXN)
          return new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' }).format(amount);
        };

        // --- DATOS INICIALES ---

        const initialTransactions = [
          { id: 1, type: 'income', amount: 45000, category: 'Salario', date: '2023-10-01', description: 'Nómina Mensual' },
          { id: 2, type: 'expense', amount: 8000, category: 'Vivienda', date: '2023-10-02', description: 'Renta departamento' },
          { id: 3, type: 'expense', amount: 3500, category: 'Alimentación', date: '2023-10-05', description: 'Supermercado' },
          { id: 4, type: 'expense', amount: 1200, category: 'Transporte', date: '2023-10-06', description: 'Gasolina' },
          { id: 5, type: 'expense', amount: 2500, category: 'Servicios', date: '2023-10-10', description: 'Luz, Agua, Internet' },
          { id: 6, type: 'expense', amount: 1500, category: 'Entretenimiento', date: '2023-10-15', description: 'Cine y Cena' },
        ];

        const riskProfiles = {
          conservador: { label: 'Conservador', bond: 70, stock: 30, color: 'bg-emerald-500', returnRate: 0.05 },
          moderado: { label: 'Moderado', bond: 50, stock: 50, color: 'bg-blue-500', returnRate: 0.08 },
          agresivo: { label: 'Agresivo', bond: 30, stock: 70, color: 'bg-orange-500', returnRate: 0.11 },
        };

        // --- APP PRINCIPAL (EL COMPONENTE 'App' es el verdadero punto de entrada de React) ---

        function App() {
          const [activeTab, setActiveTab] = useState('dashboard');
          const [transactions, setTransactions] = useState(initialTransactions);
          const [riskProfile, setRiskProfile] = useState('moderado');
          const [mobileMenuOpen, setMobileMenuOpen] = useState(false);

          // Estados para formulario
          const [newTx, setNewTx] = useState({ type: 'expense', amount: '', category: 'Alimentación', description: '' });

          // --- CÁLCULOS PRINCIPALES ---

          const summary = useMemo(() => {
            const income = transactions.filter(t => t.type === 'income').reduce((acc, t) => acc + t.amount, 0);
            const expenses = transactions.filter(t => t.type === 'expense').reduce((acc, t) => acc + t.amount, 0);
            const balance = income - expenses; // Flujo de caja libre
            const savingsRate = income > 0 ? ((income - expenses) / income) * 100 : 0;
            
            // Gastos por categoría para gráficas
            const expensesByCategory = transactions
              .filter(t => t.type === 'expense')
              .reduce((acc, t) => {
                acc[t.category] = (acc[t.category] || 0) + t.amount;
                return acc;
              }, {});

            const pieData = Object.keys(expensesByCategory).map(key => ({
              name: key,
              value: expensesByCategory[key]
            }));

            return { income, expenses, balance, savingsRate, pieData };
          }, [transactions]);

          const financialHealth = useMemo(() => {
            // Promedio de gastos mensuales (simplificado usando el total actual como un mes representativo)
            const monthlyExpenses = summary.expenses; 
            // Esto asume que el balance es el dinero ahorrado que puede usarse para el fondo
            const liquidSavings = 50000; // Valor fijo de ejemplo para el balance actual de ahorro
            const monthsOfRunway = monthlyExpenses > 0 ? (liquidSavings / monthlyExpenses) : 0; 
            
            return { monthsOfRunway, monthlyExpenses };
          }, [summary]);

          const projectionData = useMemo(() => {
            const rate = riskProfiles[riskProfile].returnRate;
            // Asumimos que el balance (flujo de caja libre) es la contribución mensual
            const monthlyContribution = summary.balance > 0 ? summary.balance : 0; 
            const years = 10;
            const data = [];
            let currentWealth = 0; // Se asume un patrimonio inicial de 0 para simplificar

            for (let i = 0; i <= years; i++) {
              data.push({ label: `Año ${i}`, value: Math.round(currentWealth) });
              // Interés compuesto (anual simple para proyección) + contribución mensual * 12
              currentWealth = (currentWealth + (monthlyContribution * 12)) * (1 + rate);
            }
            return data;
          }, [summary.balance, riskProfile]);

          // --- HANDLERS ---

          const addTransaction = (e) => {
            e.preventDefault();
            if (!newTx.amount || !newTx.description) return;
            const tx = {
              id: Date.now(),
              ...newTx,
              amount: parseFloat(newTx.amount),
              date: new Date().toISOString().split('T')[0]
            };
            setTransactions([tx, ...transactions]);
            setNewTx({ type: 'expense', amount: '', category: 'Alimentación', description: '' });
          };

          const deleteTransaction = (id) => {
            setTransactions(transactions.filter(t => t.id !== id));
          };

          // --- VISTAS ---

          const renderDashboard = () => (
            <div className="space-y-6">
              {/* KPI Cards */}
              <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                <Card className="border-l-4 border-indigo-500">
                  <div className="flex justify-between items-start">
                    <div>
                      <p className="text-sm text-slate-500 font-medium">Flujo de Caja Libre</p>
                      <h3 className="text-2xl font-bold text-slate-800">{formatCurrency(summary.balance)}</h3>
                    </div>
                    <div className="p-2 bg-indigo-50 rounded-lg text-indigo-600"><Wallet size={20} /></div>
                  </div>
                  <div className="mt-2 text-xs text-indigo-600 font-medium">+ disponible para ahorrar/invertir</div>
                </Card>
                <Card className="border-l-4 border-emerald-500">
                  <div className="flex justify-between items-start">
                    <div>
                      <p className="text-sm text-slate-500 font-medium">Ingresos</p>
                      <h3 className="text-2xl font-bold text-slate-800">{formatCurrency(summary.income)}</h3>
                    </div>
                    <div className="p-2 bg-emerald-50 rounded-lg text-emerald-600"><ArrowUpRight size={20} /></div>
                  </div>
                </Card>
                <Card className="border-l-4 border-red-500">
                  <div className="flex justify-between items-start">
                    <div>
                      <p className="text-sm text-slate-500 font-medium">Gastos</p>
                      <h3 className="text-2xl font-bold text-slate-800">{formatCurrency(summary.expenses)}</h3>
                    </div>
                    <div className="p-2 bg-red-50 rounded-lg text-red-600"><ArrowDownRight size={20} /></div>
                  </div>
                </Card>
              </div>

              <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <Card>
                  <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <PieChart size={18} className="text-indigo-500"/> Distribución de Gastos
                  </h3>
                  <div className="flex flex-col sm:flex-row items-center justify-center gap-8">
                    <SimplePieChart 
                      data={summary.pieData} 
                      colors={['#6366f1', '#ec4899', '#f59e0b', '#10b981', '#ef4444', '#8b5cf6']} 
                    />
                    <div className="space-y-2 text-sm w-full sm:w-auto">
                      {summary.pieData.map((d, i) => (
                        <div key={i} className="flex items-center justify-between gap-4">
                          <div className="flex items-center gap-2">
                            <span className="w-3 h-3 rounded-full" style={{ backgroundColor: ['#6366f1', '#ec4899', '#f59e0b', '#10b981', '#ef4444', '#8b5cf6'][i % 6] }}></span>
                            <span className="text-slate-600">{d.name}</span>
                          </div>
                          <span className="font-bold text-slate-800">{summary.expenses > 0 ? Math.round((d.value / summary.expenses) * 100) : 0}%</span>
                        </div>
                      ))}
                    </div>
                  </div>
                </Card>

                <Card>
                   <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                    <Activity size={18} className="text-emerald-500"/> Salud Financiera
                  </h3>
                  <div className="space-y-6">
                    <div>
                      <div className="flex justify-between mb-1">
                        <span className="text-sm font-medium text-slate-700">Tasa de Ahorro</span>
                        <span className={`text-sm font-bold ${summary.savingsRate > 20 ? 'text-emerald-600' : 'text-orange-500'}`}>
                          {summary.savingsRate.toFixed(1)}%
                        </span>
                      </div>
                      <div className="w-full bg-slate-100 rounded-full h-2.5">
                        <div className={`h-2.5 rounded-full ${summary.savingsRate > 20 ? 'bg-emerald-500' : 'bg-orange-500'}`} style={{ width: `${Math.min(summary.savingsRate, 100)}%` }}></div>
                      </div>
                      <p className="text-xs text-slate-500 mt-1">Objetivo recomendado: 20% del ingreso.</p>
                    </div>

                    <div className="p-4 bg-indigo-50 rounded-lg border border-indigo-100">
                       <div className="flex items-center gap-3 mb-2">
                         <Shield className="text-indigo-600" size={20} />
                         <h4 className="font-bold text-indigo-900">Fondo de Emergencia</h4>
                       </div>
                       <p className="text-sm text-indigo-800 mb-2">
                         Con tus ahorros líquidos, cubres <span className="font-bold">{financialHealth.monthsOfRunway.toFixed(1)} meses</span> de gastos básicos ({formatCurrency(financialHealth.monthlyExpenses)}).
                       </p>
                       <div className="flex gap-1 mt-2">
                         {[1,2,3,4,5,6].map(m => (
                           <div key={m} className={`h-2 flex-1 rounded-sm ${m <= financialHealth.monthsOfRunway ? 'bg-indigo-500' : 'bg-indigo-200'}`}></div>
                         ))}
                       </div>
                       <p className="text-xs text-indigo-600 mt-1 text-right">Meta: 6 meses</p>
                    </div>
                  </div>
                </Card>
              </div>
            </div>
          );

          const renderTransactions = () => (
            <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
              <div className="lg:col-span-1">
                <Card className="sticky top-6">
                  <h3 className="text-lg font-bold text-slate-800 mb-4">Nueva Transacción</h3>
                  <form onSubmit={addTransaction} className="space-y-4">
                    <div>
                      <label className="block text-xs font-medium text-slate-500 mb-1">Tipo</label>
                      <div className="flex bg-slate-100 p-1 rounded-lg">
                        <button 
                          type="button"
                          onClick={() => setNewTx({...newTx, type: 'income'})}
                          className={`flex-1 py-2 text-sm font-medium rounded-md transition-all ${newTx.type === 'income' ? 'bg-white shadow text-emerald-600' : 'text-slate-500'}`}
                        >Ingreso</button>
                        <button 
                          type="button"
                          onClick={() => setNewTx({...newTx, type: 'expense'})}
                          className={`flex-1 py-2 text-sm font-medium rounded-md transition-all ${newTx.type === 'expense' ? 'bg-white shadow text-red-600' : 'text-slate-500'}`}
                        >Gasto</button>
                      </div>
                    </div>
                    
                    <div>
                      <label className="block text-xs font-medium text-slate-500 mb-1">Monto</label>
                      <div className="relative">
                        <DollarSign className="absolute left-3 top-2.5 text-slate-400" size={16} />
                        <input 
                          type="number" 
                          required
                          value={newTx.amount}
                          onChange={(e) => setNewTx({...newTx, amount: e.target.value})}
                          className="w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-all"
                          placeholder="0.00"
                        />
                      </div>
                    </div>

                    <div>
                      <label className="block text-xs font-medium text-slate-500 mb-1">Categoría</label>
                      <select 
                        value={newTx.category}
                        onChange={(e) => setNewTx({...newTx, category: e.target.value})}
                        className="w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
                      >
                        {newTx.type === 'expense' ? (
                          <>
                            <option>Alimentación</option>
                            <option>Transporte</option>
                            <option>Vivienda</option>
                            <option>Servicios</option>
                            <option>Entretenimiento</option>
                            <option>Salud</option>
                            <option>Deuda</option>
                            <option>Otros</option>
                          </>
                        ) : (
                          <>
                            <option>Salario</option>
                            <option>Freelance</option>
                            <option>Inversiones</option>
                            <option>Regalo</option>
                          </>
                        )}
                      </select>
                    </div>

                    <div>
                      <label className="block text-xs font-medium text-slate-500 mb-1">Descripción</label>
                      <input 
                        type="text" 
                        required
                        value={newTx.description}
                        onChange={(e) => setNewTx({...newTx, description: e.target.value})}
                        className="w-full px-4 py-2 bg-slate-50 border border-slate-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"
                        placeholder="Ej. Tacos de la esquina"
                      />
                    </div>

                    <Button type="submit" className="w-full" icon={Plus}>Agregar</Button>
                  </form>
                </Card>
              </div>

              <div className="lg:col-span-2">
                <Card>
                  <div className="flex justify-between items-center mb-6">
                    <h3 className="text-lg font-bold text-slate-800">Historial Reciente</h3>
                    <span className="text-xs font-medium bg-slate-100 text-slate-600 px-2 py-1 rounded-full">{transactions.length} registros</span>
                  </div>
                  
                  <div className="overflow-x-auto">
                    <table className="w-full text-left">
                      <thead>
                        <tr className="border-b border-slate-100 text-xs text-slate-500 uppercase tracking-wider">
                          <th className="pb-3 pl-2">Fecha</th>
                          <th className="pb-3">Descripción</th>
                          <th className="pb-3">Categoría</th>
                          <th className="pb-3 text-right">Monto</th>
                          <th className="pb-3 text-center">Acción</th>
                        </tr>
                      </thead>
                      <tbody className="text-sm">
                        {transactions.map(t => (
                          <tr key={t.id} className="group hover:bg-slate-50 transition-colors border-b border-slate-50 last:border-0">
                            <td className="py-3 pl-2 text-slate-500">{t.date}</td>
                            <td className="py-3 font-medium text-slate-700">{t.description}</td>
                            <td className="py-3">
                              <span className="px-2 py-1 rounded-full text-xs bg-slate-100 text-slate-600">{t.category}</span>
                            </td>
                            <td className={`py-3 text-right font-bold ${t.type === 'income' ? 'text-emerald-600' : 'text-slate-700'}`}>
                              {t.type === 'income' ? '+' : '-'}{formatCurrency(t.amount)}
                            </td>
                            <td className="py-3 text-center">
                              <button onClick={() => deleteTransaction(t.id)} className="text-slate-300 hover:text-red-500 transition-colors">
                                <Trash2 size={16} />
                              </button>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                    {transactions.length === 0 && (
                      <div className="text-center py-10 text-slate-400">
                        No hay transacciones registradas.
                      </div>
                    )}
                  </div>
                </Card>
              </div>
            </div>
          );

          const renderPortfolio = () => (
            <div className="space-y-6">
              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div className="lg:col-span-1 space-y-6">
                  <Card>
                    <h3 className="text-lg font-bold text-slate-800 mb-4 flex items-center gap-2">
                      <Target size={18} className="text-indigo-500"/> Perfil de Riesgo
                    </h3>
                    <p className="text-sm text-slate-500 mb-6">Selecciona una estrategia basada en tu tolerancia al riesgo y horizonte temporal.</p>
                    
                    <div className="space-y-3">
                      {Object.entries(riskProfiles).map(([key, profile]) => (
                        <div 
                          key={key}
                          onClick={() => setRiskProfile(key)}
                          className={`cursor-pointer p-4 rounded-xl border-2 transition-all ${riskProfile === key ? 'border-indigo-500 bg-indigo-50' : 'border-slate-100 hover:border-slate-200'}`}
                        >
                          <div className="flex justify-between items-center mb-2">
                            <h4 className={`font-bold ${riskProfile === key ? 'text-indigo-700' : 'text-slate-700'}`}>{profile.label}</h4>
                            {riskProfile === key && <div className="w-3 h-3 bg-indigo-500 rounded-full shadow-sm"></div>}
                          </div>
                          <div className="flex gap-2 text-xs font-medium">
                            <span className="px-2 py-1 bg-white rounded text-blue-600 border border-blue-100">{profile.stock}% Acciones</span>
                            <span className="px-2 py-1 bg-white rounded text-emerald-600 border border-emerald-100">{profile.bond}% Renta Fija</span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </Card>

                  <Card className="bg-slate-900 text-white border-none">
                    <h3 className="text-lg font-bold mb-2">Resumen del Plan</h3>
                    <div className="space-y-4">
                      <div>
                        <span className="text-slate-400 text-xs">Retorno Anual Estimado</span>
                        <p className="text-2xl font-bold text-emerald-400">{(riskProfiles[riskProfile].returnRate * 100).toFixed(1)}%</p>
                      </div>
                      <div className="pt-4 border-t border-slate-700">
                        <span className="text-slate-400 text-xs">Contribución Mensual Proyectada</span>
                        <p className="text-xl font-bold text-white">{formatCurrency(Math.max(0, summary.balance))}</p>
                        <p className="text-xs text-slate-400 mt-1">*Basado en tu flujo de caja libre actual</p>
                      </div>
                    </div>
                  </Card>
                </div>

                <div className="lg:col-span-2 space-y-6">
                  <Card>
                     <h3 className="text-lg font-bold text-slate-800 mb-6 flex items-center gap-2">
                      <TrendingUp size={18} className="text-indigo-500"/> Proyección de Patrimonio (10 Años)
                    </h3>
                    <div className="h-64 flex items-end justify-center w-full px-4">
                       {/* Gráfico de barras simple para proyección */}
                       <BarChart data={projectionData} height={240} />
                    </div>
                     <div className="mt-4 text-center">
                       <p className="text-sm text-slate-500">
                         Patrimonio proyectado en 10 años: <span className="font-bold text-indigo-600">{formatCurrency(projectionData[projectionData.length - 1].value)}</span>
                       </p>
                     </div>
                  </Card>

                  <Card>
                    <h3 className="text-lg font-bold text-slate-800 mb-4">Composición Ideal</h3>
                    <div className="flex flex-col md:flex-row items-center gap-8">
                      <div className="relative w-48 h-48">
                         <SimplePieChart 
                           data={[
                             { name: 'Acciones (Crecimiento)', value: riskProfiles[riskProfile].stock }, 
                             { name: 'Bonos (Estabilidad)', value: riskProfiles[riskProfile].bond }
                           ]} 
                           colors={['#6366f1', '#10b981']} 
                         />
                      </div>
                      <div className="flex-1 space-y-4">
                        <div className="flex items-start gap-3">
                          <div className="p-2 bg-indigo-100 rounded text-indigo-600"><TrendingUp size={18}/></div>
                          <div>
                            <h4 className="font-bold text-slate-800">Renta Variable (Acciones) - {riskProfiles[riskProfile].stock}%</h4>
                            <p className="text-xs text-slate-500 mt-1">
                              Enfocado en crecimiento a largo plazo. Mayor potencial de rentabilidad, pero también mayor volatilidad.
                            </p>
                          </div>
                        </div>
                        <div className="flex items-start gap-3">
                          <div className="p-2 bg-emerald-100 rounded text-emerald-600"><Shield size={18}/></div>
                          <div>
                            <h4 className="font-bold text-slate-800">Renta Fija (Bonos/Deuda) - {riskProfiles[riskProfile].bond}%</h4>
                            <p className="text-xs text-slate-500 mt-1">
                              Enfocado en preservación de capital y estabilidad. Proporciona ingresos fijos periódicos.
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </Card>
                </div>
              </div>
            </div>
          );

          // --- NAVEGACIÓN Y LAYOUT ---

          const NavItem = ({ id, label, icon: Icon }) => (
            <button
              onClick={() => { setActiveTab(id); setMobileMenuOpen(false); }}
              className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-medium ${activeTab === id ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-200' : 'text-slate-500 hover:bg-slate-50 hover:text-slate-900'}`}
            >
              <Icon size={20} />
              <span>{label}</span>
            </button>
          );

          return (
            <div className="min-h-screen bg-slate-50 font-sans text-slate-900">
              {/* Sidebar Desktop */}
              <aside className="hidden lg:flex flex-col w-64 h-screen fixed bg-white border-r border-slate-200 px-4 py-6">
                <div className="flex items-center gap-2 px-2 mb-10">
                  <div className="bg-indigo-600 p-2 rounded-lg text-white">
                    <TrendingUp size={24} />
                  </div>
                  <div>
                    <h1 className="font-bold text-xl tracking-tight text-slate-900">Libertad</h1>
                    <p className="text-xs text-indigo-600 font-bold uppercase tracking-wider">Financiera 360</p>
                  </div>
                </div>
                
                <nav className="flex-1 space-y-2">
                  <NavItem id="dashboard" label="Dashboard" icon={Activity} />
                  <NavItem id="transactions" label="Ingresos y Gastos" icon={Wallet} />
                  <NavItem id="portfolio" label="Inversiones" icon={Briefcase} />
                </nav>

                <div className="mt-auto pt-6 border-t border-slate-100">
                  <div className="bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl p-4 text-white">
                    <h4 className="font-bold text-sm mb-1">Tu meta principal</h4>
                    <p className="text-xs opacity-90 mb-3">Fondo de emergencia (6 meses)</p>
                    <div className="w-full bg-black/20 rounded-full h-1.5">
                      <div className="bg-white rounded-full h-1.5" style={{ width: `${Math.min((financialHealth.monthsOfRunway/6)*100, 100)}%` }}></div>
                    </div>
                  </div>
                </div>
              </aside>

              {/* Mobile Header */}
              <header className="lg:hidden bg-white border-b border-slate-200 p-4 sticky top-0 z-20 flex justify-between items-center">
                <div className="flex items-center gap-2">
                  <div className="bg-indigo-600 p-1.5 rounded-lg text-white">
                    <TrendingUp size={20} />
                  </div>
                  <span className="font-bold text-lg">LF 360</span>
                </div>
                <button onClick={() => setMobileMenuOpen(!mobileMenuOpen)} className="text-slate-600">
                  {mobileMenuOpen ? <X size={24} /> : <Menu size={24} />}
                </button>
              </header>

              {/* Mobile Menu Overlay */}
              {mobileMenuOpen && (
                <div className="lg:hidden fixed inset-0 bg-white z-10 pt-20 px-6 space-y-4">
                  <NavItem id="dashboard" label="Dashboard" icon={Activity} />
                  <NavItem id="transactions" label="Ingresos y Gastos" icon={Wallet} />
                  <NavItem id="portfolio" label="Inversiones" icon={Briefcase} />
                </div>
              )}

              {/* Main Content */}
              <main className="lg:ml-64 p-4 lg:p-8 max-w-7xl mx-auto">
                <header className="mb-8">
                  <h2 className="text-2xl font-bold text-slate-800">
                    {activeTab === 'dashboard' && 'Visión General'}
                    {activeTab === 'transactions' && 'Gestión de Transacciones'}
                    {activeTab === 'portfolio' && 'Estrategia de Inversión'}
                  </h2>
                  <p className="text-slate-500">
                    {activeTab === 'dashboard' && 'Monitorea tus indicadores clave hacia la libertad financiera.'}
                    {activeTab === 'transactions' && 'Registra cada movimiento para mantener el control.'}
                    {activeTab === 'portfolio' && 'Construye patrimonio con un plan adaptado a ti.'}
                  </p>
                </header>

                {activeTab === 'dashboard' && renderDashboard()}
                {activeTab === 'transactions' && renderTransactions()}
                {activeTab === 'portfolio' && renderPortfolio()}
              </main>
            </div>
          );
        }

        // Montaje del componente principal en el DOM
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>